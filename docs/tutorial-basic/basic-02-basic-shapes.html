<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/d3js-tutorial/assets/css/just-the-docs-default.css"> <script src="/d3js-tutorial/assets/js/vendor/lunr.min.js"></script> <script src="/d3js-tutorial/assets/js/just-the-docs.js"></script> <script src="/d3js-tutorial/assets/js/d3.v7.min.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/d3js-tutorial/" class="site-title lh-tight"> D3js </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/d3js-tutorial/" class="nav-list-link">Home</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Basic Tutorial category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/d3js-tutorial/docs/tutorial-basic/" class="nav-list-link">Basic Tutorial</a><ul class="nav-list"><li class="nav-list-item"><a href="/d3js-tutorial/docs/tutorial-basic/basic-01-dom-manipulation.html" class="nav-list-link">DOM Manipulation</a></li><li class="nav-list-item"><a href="/d3js-tutorial/docs/tutorial-basic/basic-02-basic-shapes.html" class="nav-list-link">Basic Shapes</a></li><li class="nav-list-item"><a href="/d3js-tutorial/docs/tutorial-basic/basic-03-data.html" class="nav-list-link">Data</a></li><li class="nav-list-item"><a href="/d3js-tutorial/docs/tutorial-basic/template.html" class="nav-list-link">Title</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Intermediate Tutorial category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/d3js-tutorial/docs/tutorial-intermediate/" class="nav-list-link">Intermediate Tutorial</a><ul class="nav-list"><li class="nav-list-item"><a href="/d3js-tutorial/docs/tutorial-intermediate/intermediate-1.html" class="nav-list-link">Intermediate-1</a></li><li class="nav-list-item"><a href="/d3js-tutorial/docs/tutorial-intermediate/intermediate-2.html" class="nav-list-link">Intermediate-2</a></li></ul></li><li class="nav-list-item"><a href="/d3js-tutorial/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search D3js" aria-label="Search D3js" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/d3js-tutorial/docs/tutorial-basic/">Basic Tutorial</a></li> <li class="breadcrumb-nav-list-item"><span>Basic Shapes</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="basic-shapes"> <a href="#basic-shapes" class="anchor-heading" aria-labelledby="basic-shapes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Basic Shapes </h1> <p>The usual method for adding shapes in D3.js is by first adding an <code class="language-plaintext highlighter-rouge">svg</code> component, which is a native html container for SVG graphics, and then add SVG shapes to it.</p> <p>In the first example below, we start by adding the SVG element of size 200 by 200 pixels. We then append a rectangle with a larger dimension of 300 by 200 pixes to the container, and also move the x and y coordinates a little (the coordinate where the shape is located). We can see how only part of the rectangle is shown. In general, we should make sure that the SVG container is large enough to display the elements contained within it.</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">"</span><span class="s2">#basic-shapes-01</span><span class="dl">"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">svg</span><span class="dl">"</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">"</span><span class="s2">width</span><span class="dl">"</span><span class="p">,</span> <span class="mi">200</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">"</span><span class="s2">height</span><span class="dl">"</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
  <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">rect</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">x</span><span class="dl">'</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>       <span class="c1">// horizontal (from left) coordinate</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">y</span><span class="dl">'</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>      <span class="c1">// vertical (from top) coordinate</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">rx</span><span class="dl">'</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>     <span class="c1">// setting for rounded corners</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">ry</span><span class="dl">'</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>     <span class="c1">// setting for rounded corners</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">width</span><span class="dl">'</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">height</span><span class="dl">'</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">stroke</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="dl">'</span><span class="s1">thistle</span><span class="dl">'</span><span class="p">))</span> <span class="c1">// border colour</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">stroke-width</span><span class="dl">'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>             <span class="c1">// border thickness</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="dl">'</span><span class="s1">lavender</span><span class="dl">'</span><span class="p">))</span>
</code></pre></div></div> <div id="basic-shapes-01"> </div> <script src="/d3js-tutorial/assets/js/02/01-basic-rect.js"></script> <p>In the above example, we call <code class="language-plaintext highlighter-rouge">attr()</code> once for each attribute we want to set. We can also call <code class="language-plaintext highlighter-rouge">attr()</code> once and passing it an object with key-value pairs, but the style with multiple <code class="language-plaintext highlighter-rouge">attr()</code> calls seem to be more common, and I find it easier to edit.</p> <p>To add multiple shapes we can use a for loop to call append multiple times.</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">"</span><span class="s2">#basic-shapes-02</span><span class="dl">"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">svg</span><span class="dl">"</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">"</span><span class="s2">width</span><span class="dl">"</span><span class="p">,</span> <span class="mi">600</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">"</span><span class="s2">height</span><span class="dl">"</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">height</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">width</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>

<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">rect</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">x</span><span class="dl">'</span><span class="p">,</span> <span class="nx">i</span><span class="o">*</span><span class="nx">width</span><span class="p">)</span>       
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">y</span><span class="dl">'</span><span class="p">,</span> <span class="nx">i</span><span class="o">*</span><span class="nx">height</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">height</span><span class="dl">'</span><span class="p">,</span><span class="nx">height</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">width</span><span class="dl">'</span><span class="p">,</span><span class="nx">width</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">stroke</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="dl">'</span><span class="s1">thistle</span><span class="dl">'</span><span class="p">))</span> 
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">stroke-width</span><span class="dl">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>             
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="dl">'</span><span class="s1">lavender</span><span class="dl">'</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div></div> <div id="basic-shapes-02"> </div> <script src="/d3js-tutorial/assets/js/02/02-multi-rect.js"></script> <p>However, in the spirit of data-driven design, D3.js has the ability to extract values from an array to use as the shape parameters, as we can see below:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">"</span><span class="s2">#basic-shapes-03</span><span class="dl">"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">svg</span><span class="dl">"</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">"</span><span class="s2">width</span><span class="dl">"</span><span class="p">,</span> <span class="mi">600</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">"</span><span class="s2">height</span><span class="dl">"</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
  <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span>  <span class="mi">5</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">18</span><span class="p">},</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">83</span><span class="p">},</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">43</span><span class="p">},</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="mi">65</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">90</span><span class="p">},</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="mi">85</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">110</span><span class="p">},</span> 
              <span class="p">{</span><span class="na">x</span><span class="p">:</span><span class="mi">105</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">73</span><span class="p">},</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">23</span><span class="p">}</span>
            <span class="p">]</span>

  <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">rect</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">rect</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">y</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>                <span class="c1">// use y property of each object in the array </span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">x</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="mi">80</span> <span class="o">*</span> <span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1">// i is the index of the object in the array</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">rx</span><span class="dl">'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>     
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">ry</span><span class="dl">'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> 
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">width</span><span class="dl">'</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">height</span><span class="dl">'</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="dl">'</span><span class="s1">lavender</span><span class="dl">'</span><span class="p">))</span>
</code></pre></div></div> <div id="basic-shapes-03"> </div> <script src="/d3js-tutorial/assets/js/02/03-rect-from-data.js"></script> <p>Here we use <code class="language-plaintext highlighter-rouge">selectAll('rect')</code> to tell D3.js to select all rectangles, even though at this point there are no rectangles. Hopefully it will make more sense later on. The next two lines are the important bits that make this work:</p> <ul> <li><code class="language-plaintext highlighter-rouge">.data()</code> binds the selection (of all rectangles) to the array.</li> <li><code class="language-plaintext highlighter-rouge">.enter()</code> creates a <em>virtual</em> rectangle for each element in the array, which probably does not make much sense now either.</li> </ul> <p>Once the data is bound to the selection, and enough rectangles are created, the <code class="language-plaintext highlighter-rouge">append()</code> function will create the actual rectangles as in the previous examples, except this time with access to some data to set the attributes. The significance of <code class="language-plaintext highlighter-rouge">enter()</code> (vs <code class="language-plaintext highlighter-rouge">exit()</code>) will be made clear in later sections, but for now we can treat it as something that has to be done before we call <code class="language-plaintext highlighter-rouge">append()</code>.</p> <p>To use the values in the array, we pass an anonymous function with parameter <code class="language-plaintext highlighter-rouge">(d,i)</code> where <code class="language-plaintext highlighter-rouge">d</code> is the array element and <code class="language-plaintext highlighter-rouge">i</code> is its index. In the above example, we set the y-coordinate to be the <code class="language-plaintext highlighter-rouge">y</code> value of each object in the array, where as the <code class="language-plaintext highlighter-rouge">x</code> depends on the index of the element.</p> <p>There is one more optional parameter <code class="language-plaintext highlighter-rouge">nodes</code> that refers to the DOM elements that are created, in this example, an array of SVG rectangles. In the next code below, we use <code class="language-plaintext highlighter-rouge">d3.select(nodes[i-1]).attr('cy')</code> to get the previous circle’s <code class="language-plaintext highlighter-rouge">cy</code> attribute to check if the value is the same with the current node — darker circles mean it has the same value as the previous circle.</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">width</span> <span class="o">=</span> <span class="mi">600</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">"</span><span class="s2">#basic-shapes-04</span><span class="dl">"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">svg</span><span class="dl">"</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">"</span><span class="s2">width</span><span class="dl">"</span><span class="p">,</span> <span class="mi">600</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">"</span><span class="s2">height</span><span class="dl">"</span><span class="p">,</span> <span class="nx">height</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">74</span> <span class="p">]</span>

<span class="kd">var</span> <span class="nx">gap</span> <span class="o">=</span> <span class="nx">width</span> <span class="o">/</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">circle</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">circle</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cx</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">gap</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">gap</span><span class="p">)</span> <span class="c1">// x-coordinate</span>
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cy</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">height</span> <span class="o">-</span> <span class="nx">d</span><span class="p">)</span>      <span class="c1">// y-coordinate</span>
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">r</span><span class="dl">'</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>                       <span class="c1">// radius</span>
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">nodes</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
      <span class="k">return</span> <span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cy</span><span class="dl">'</span><span class="p">)</span> <span class="o">==</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cy</span><span class="dl">'</span><span class="p">))</span> <span class="p">?</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="dl">'</span><span class="s1">thistle</span><span class="dl">'</span><span class="p">)</span> <span class="p">:</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="dl">'</span><span class="s1">lavender</span><span class="dl">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="dl">'</span><span class="s1">lavender</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">})</span>
</code></pre></div></div> <div id="basic-shapes-04"> </div> <script src="/d3js-tutorial/assets/js/02/04-circle-from-data.js"></script> <p>We have to use <code class="language-plaintext highlighter-rouge">select()</code> because we are selecting a DOM element, and also we cannot directly use <code class="language-plaintext highlighter-rouge">cy</code> from <code class="language-plaintext highlighter-rouge">nodes[i-1]</code> for the same reason. Another, possibly simpler method, is to use the values from the <code class="language-plaintext highlighter-rouge">data</code> array using the <code class="language-plaintext highlighter-rouge">datum()</code> function like so:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]).</span><span class="nx">datum</span><span class="p">()</span>
</code></pre></div></div> <p>In the following code, we use <code class="language-plaintext highlighter-rouge">datum()</code> to use darker colour if a circle has value &lt; 75.</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">"</span><span class="s2">#basic-shapes-05</span><span class="dl">"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">svg</span><span class="dl">"</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">"</span><span class="s2">width</span><span class="dl">"</span><span class="p">,</span> <span class="nx">width</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">"</span><span class="s2">height</span><span class="dl">"</span><span class="p">,</span> <span class="nx">height</span><span class="p">)</span>
<span class="nx">data</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">74</span> <span class="p">]</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">circle</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">circle</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cx</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">gap</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">gap</span><span class="p">)</span> 
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cy</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">height</span> <span class="o">-</span> <span class="nx">d</span><span class="p">)</span>      
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">r</span><span class="dl">'</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>                      
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">nodes</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">datum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">75</span><span class="p">)</span> <span class="p">?</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="dl">'</span><span class="s1">lavender</span><span class="dl">'</span><span class="p">)</span> <span class="p">:</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="dl">'</span><span class="s1">thistle</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">})</span>
</code></pre></div></div> <div id="basic-shapes-05"> </div> <script src="/d3js-tutorial/assets/js/02/05-circle-from-data.js"></script> <p>Now to explain why we use <code class="language-plaintext highlighter-rouge">selectAll()</code> even when there were no shapes, and also the significance of <code class="language-plaintext highlighter-rouge">enter()</code> and <code class="language-plaintext highlighter-rouge">exit()</code>. When we bind data to a selection in D3.js, this is not a one-off process, in a sense that D3.js can detect changes to underlying data and update the SVG accordingly.</p> <div id="basic-shapes-06"> </div> <p><button type="button" class="btn" id="add-and-remove-button" onclick="add_and_remove()">Click me</button></p> <div id="basic-shapes-07"> </div> <script src="/d3js-tutorial/assets/js/02/06-enter-exit-example.js"></script> <p><button type="button" class="btn" id="enter-exit-example-button" onclick="randomise()">Click me</button></p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
